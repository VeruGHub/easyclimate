---
title: "Manual"
author: "Verónica Cruz"
date: "26/8/2020"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

##1. General description

The "Downscaled European Climate Data" (Moreno & Hasenauer 2015) includes daily climatic data (precipitation, minimum and maximum temperature) with a spatial resolution of 0083x0083 degrees (~1 km2).
It covers Europe and the most northern part of Africa. 
Initially, it spanned from 1950 to 2012 but in 2018 it was updated to 2017 (v2). 
The first release included tif files with:
- all data, i.e. daily climatic data expaning the whole spatial and temporal extension ("AllDataRasters").
- tiled data, i.e. daily climatic data by spatial tiles expaning the complete temporal extension ("TiledClimateData")
- yearly data, i.e. yearly climatic data expaning the whole spatial and temporal extension ("YearlyAvgs/AnnualDataRasters")
- periodic data, i.e. mean climatic data for two periods (1951-1980 and 1981-2010) ("PeriodicDataRasters")

The v1 resease does not include the periodic data. 
The v2 resease does not include the tiled data. This implies that to use the daily data from 2013 to 2017 we will need to download huge files covering the whole spatial extent.
In all cases temperatures are given as celsius * 100 and precipitation is given as mm * 100.

###1.1. All data

Includes individual folders for Tmin, Tmax, and Prcp.  
Within those folders there are raster datasets for each year. Each year has 365 bands, even if it is a leap year. Each band is a day starting on Jan 1. Each map is large (~17 Gb for temperatures; 4-7.5 Gb for precipitation) and will take time to download.

###1.2. Tiled data

If you want to only focus on a particular area in Europe this is a good option.  Within this folder you will find the image that lays out the tiles. Letters correspond to the x-axis of the tiles and numbers to the y-axis of the tiles. In each letter/number folder will be all climate data for that tile. Again every map has 365 bands.
Tiles are defined in docs/WithGrids.tif

REVISAR: que son los archivos _v2 de la primera base de datos??

###1.3. Yearly averages

Mean temperatures and annual total precipitation were calculated for points with coverage greater than >95%, coverage being the number of days with non-NA data for the respective year. Mean temperatures were calculated by dividing the sum of daily temperatures by the number of days with valid data (non-NA). Annual total Prcp was calculated by adding up the daily precipitation data for the respective year.
In both versions there is a file per year and climatic variable, but v1 includes Tmin, Tmax and Prcp, and v2 includes Tavg and Prec. Average temperature Tavg is taken as the mean of minimum temperature (Tmin) and maximum temperature (Tmax).


###1.4. Periodic avegages

In v2, there are also periodic data rasters (1951-1980 and 1981-2010), where each band represents the mean climate (Tavg and Prcp) of each year.
Perdiodic Tavg and Prcp were calculated for points with coverage of greater than 95%, coverage being the number of years with non-NA data within the respective period. Periodic mean for both variables (Tavg and Prcp) was calculated by dividing the sum of the annual data by the number of years with non-NA data.


##2. Functions

###2.1. tile.selection (POR HACER)

Queria hacer una funcion que con las coordenadas de tus puntos, te diera el tile que te tienes que bajar, pero la imagen de los tiles (WithGrids.tif) no esta georregerenciada. 
Habría que o bien georreferenciar la imagen y dibujar la cuadricula en GIS o bien descargar alguna información de cada tile y comprobar la extención.

###2.2. download.daily.data

As a function of: 
-year: a vector of years whose climatic information you need
-tile: a vector of tiles expaning the extent you need
-var: variables to be downloaded (Prcp, Tmax, Tmin)
-path: path to save the data (within the working directory) 

Para mejorar:
-que se pueda poner cualquier path y no solo uno cuya raiz sea el working directory
-que primero chequee si ya tienes el archivo y no lo vuelva a bajar en vez de sobreescribirlo

###2.3. Extract.daily.data (POR HACER)


###2.4. Climatic variables (POR HACER)

-Número de heladas en primavera
-Olas de calor
-Frecuencia de sequias





```{r cars}
summary(cars)
```

```{r pressure, echo=FALSE}
plot(pressure)
```
